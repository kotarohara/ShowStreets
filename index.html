<!DOCTYPE html>
<html>
<head>
<meta charset=utf-8 />
<title>GeoJSON custom markers and style</title>
<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src='https://api.tiles.mapbox.com/mapbox.js/v2.2.1/mapbox.js'></script>
<link href='https://api.tiles.mapbox.com/mapbox.js/v2.2.1/mapbox.css' rel='stylesheet' />

<script href="SmallMap_02_Sidewalks.js"></script>
<style>
  body { margin:0; padding:0; }
  #map { position:absolute; top:0; bottom:0; width:100%; }
</style>
</head>
<body>
<div id='map'></div>
<script>

L.mapbox.accessToken = 'pk.eyJ1Ijoia290YXJvaGFyYSIsImEiOiJDdmJnOW1FIn0.kJV65G6eNXs4ATjWCtkEmA';
// L.mapbox.accessToken = 'pk.eyJ1Ijoia290YXJvaGFyYSIsImEiOiJDdmJnOW1FIn0.kJV65G6eNXs4ATjWCtkEmA';

// https://www.mapbox.com/guides/an-open-platform/#tilejson
var tileJson = {
  "tiles": [ "https://api.tiles.mapbox.com/v4/mapbox.streets/{z}/{x}/{y}.png?access_token=pk.eyJ1Ijoia290YXJvaGFyYSIsImEiOiJDdmJnOW1FIn0.kJV65G6eNXs4ATjWCtkEmA" ],
  "minzoom": 0,
  "maxzoom": 18
};

// Tile:
// https://www.mapbox.com/developers/api/maps/#tilejson
// var map = L.mapbox.map('map', 'mapbox.emerald')
var map = L.mapbox.map('map')
    .setView([
      38.896146088499464,
      -76.98064010565248
          ], 15);

var tileLayer = L.tileLayer('https://{s}.tiles.mapbox.com/v3/{id}/{z}/{x}/{y}.png', {
  maxZoom: 20,
  attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
    '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
    'Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
  id: 'examples.map-20v6611k'
});

tileLayer.addTo(map);

// Styleing: http://leafletjs.com/examples/geojson.html
// http://leafletjs.com/reference.html#path-dasharray
// https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/stroke-dasharray
var mystyle = {
  color: "#000",
  weight: 2,
  opacity: 0.75
};
function onEachFeature(feature, layer) {
  // does this feature have a property named popupContent?
    if (feature.properties && feature.properties.type) {
      // http://gis.stackexchange.com/questions/31951/how-to-show-a-popup-on-mouse-over-not-on-click
        layer.bindPopup(feature.properties.type);
        // layer.on('mouseover', function (e) {
        //   this.openPopup();
        // });
        // layer.on('mouseout', function (e) {
        //   this.closePopup();
        // });
    }
}

$.getJSON("resources/SmallMap_02_Streets.geojson", function(data) {
  L.geoJson(data, {
    pointToLayer: L.mapbox.marker.style,
    style: function(feature) {
      // console.log(feature.properties.type);
      var tempStyle = $.extend(true, {}, mystyle);
      switch (feature.properties.type) {
        case "footway" :
          tempStyle.color = "#333";
          tempStyle.dashArray = "3, 2"
          break;
        case "crosswalk":
          tempStyle.color = "#888";
          tempStyle.opacity = 0.25;
          break;
      }

      return tempStyle;
    },
    onEachFeature: onEachFeature
  })
  .addTo(map);
})
.fail(function (result) {
  console.log(result);
});

</script>
</body>
</html>
